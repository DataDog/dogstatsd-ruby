# CHANGELOG

## Unreleased

 * Try to make this thread safe

## NEXT

### Breaking changes

 * port / host / tags / namespace can no longer be set on the instance to allow thread-safety [#87][] by [@grosser][]

## 3.3.0 / 2018.02.04

 * [FEATURE] Add distribution support (beta). See [#72][].
 * [IMPROVEMENT] A ton of cleanups and refinements courtesy of [@grosser][]. See [#68][], [#69][], [#73][], [#74][], [#75][], [#76][], [#77][].
 * [IMPROVEMENT] Unify tag handling in `format_service_check`. See [#71][] by [@grosser][].
 * [IMPROVEMENT] Use faster time method on ruby >= 2.1. See [#70][] by [@grosser][].

## 3.2.0 / 2017.12.21

* [IMPROVEMENT] Add statsd sample rate compat. [#67][], [@sj26][]

## 3.1.0 / 2017.11.23

* [FEATURE] Add Unix Domain Socket support. [#61][], [@sullerandras][]
* [IMPROVEMENT] Don't flush an empty buffer. [#58][], [@misterbyrne][]
* [BUGFIX] Use defaults when host/port are nil. [#56][], [@degemer][]
* [BUGFIX] Ignore nil tags and convert symbol. [#53][], [@pschambacher][]
* [FEATURE] Nest batch calls. [#52][], [@misterbyrne][]
* [BUGFIX] Convert tags to string type. [#51][], [@jacobbednarz][]

## 3.0.0 / 2017.05.18

* [FEATURE] Expose (socket) close method. [#46][], [@ramfjord][]
* [IMPROVEMENT] Retry once when send fails on a closed socket. [#46][], [@ramfjord][]
* [IMPROVEMENT] Use a instance variable to decide whether to batch or not. [#47][] [@fimmtiu][]

### Breaking changes
#### Host resolution

Host resolution was previously done every time a message was sent, it is now
done once when `Datadog::Statsd` is initiliazed (resulting in a non-negligible
performance improvement). [#44][], [@AMekss][]

`Datadog::Statsd.new(host, port)` will now raise a `SocketError` if unable to
resolve the `host`.

## 2.2.0 / 2017.01.12

* [IMPROVEMENT] Fewer string allocations, improves memory usage, [#40][], [@janester][]

## 2.1.0 / 2016.10.27

* [FEATURE] Add an optional `by` parameter for `#increment` and `#decrement`, [#33][]
* [BUGFIX] `#time`: record on all block exits, [#38][] [@nelhage][]
* [IMPROVEMENT] Replace string literals with symbols or frozen strings, [#37][] [@janester][]

## 2.0.0 / 2016.09.22

### Breaking changes
#### Namespace

The `Statsd` is now namespaced under the Datadog module. [#32][] [@djpate][]

To update:
- `require 'statsd'` -> `require 'datadog/statsd'`
- `Statsd` -> `Datadog::Statsd`

#### Tags

`,` is now stripped from tags to avoid unexpected behavior. [#34][] [@adimitrov][]

`Datadog::Statsd` also validates that it receives an array of tags, and strips `,` and `|` from them.

## 1.6.0 / 2015.12.21

* [IMPROVEMENT] Stop mutating input parameters, [#22][] [@olefriis][]

## 1.5.0 / 2015.05.20

### Notice

This release drops testing for Ruby 1.8.7.
Future versions are likely to introduce backward incompatibilities with < Ruby 1.9.3.

* [FEATURE] Add service checks support, [#11][]
* [FEATURE] Send time stat on failing block, [#16][] [@gleseur][]
* [BUGFIX] Add instance tags to `Statsd.event`, [#14][] [@gleseur][]
* [OTHER] Use `send_stat` instead of overriding Ruby `send` method, [#17][] [@sensadrome][]
* [OTHER] Changelog update

## 1.4.1 / 2014.09.29

* [BUGFIX] Fixed bug in message separator when batching metrics

## 1.4.0 / 2014.06.13

* [FEATURE] Added support for metrics batching

## 1.3.0 / 2014.03.27

* [FEATURE] Added support for submitting events

## 1.2.0 / 2013.07.10

* [FEATURE] Added global tags
* [FEATURE] Added ability to set namespace and tags from `Statsd#initialize`

## 1.1.0 / 2012.09.21

* [FEATURE] Added sets metrics

## 1.0.0 / 2012.06.14

* Initial release


<!--- The following link definition list is generated by PimpMyChangelog --->
[#11]: https://github.com/DataDog/dogstatsd-ruby/issues/11
[#14]: https://github.com/DataDog/dogstatsd-ruby/issues/14
[#16]: https://github.com/DataDog/dogstatsd-ruby/issues/16
[#17]: https://github.com/DataDog/dogstatsd-ruby/issues/17
[#22]: https://github.com/DataDog/dogstatsd-ruby/issues/22
[#32]: https://github.com/DataDog/dogstatsd-ruby/issues/32
[#33]: https://github.com/DataDog/dogstatsd-ruby/issues/33
[#34]: https://github.com/DataDog/dogstatsd-ruby/issues/34
[#37]: https://github.com/DataDog/dogstatsd-ruby/issues/37
[#38]: https://github.com/DataDog/dogstatsd-ruby/issues/38
[#40]: https://github.com/DataDog/dogstatsd-ruby/issues/40
[#44]: https://github.com/DataDog/dogstatsd-ruby/issues/44
[#46]: https://github.com/DataDog/dogstatsd-ruby/issues/46
[#47]: https://github.com/DataDog/dogstatsd-ruby/issues/47
[#51]: https://github.com/DataDog/dogstatsd-ruby/issues/51
[#52]: https://github.com/DataDog/dogstatsd-ruby/issues/52
[#53]: https://github.com/DataDog/dogstatsd-ruby/issues/53
[#56]: https://github.com/DataDog/dogstatsd-ruby/issues/56
[#58]: https://github.com/DataDog/dogstatsd-ruby/issues/58
[#61]: https://github.com/DataDog/dogstatsd-ruby/issues/61
[#67]: https://github.com/DataDog/dogstatsd-ruby/issues/67
[#68]: https://github.com/DataDog/dogstatsd-ruby/issues/68
[#69]: https://github.com/DataDog/dogstatsd-ruby/issues/69
[#70]: https://github.com/DataDog/dogstatsd-ruby/issues/70
[#71]: https://github.com/DataDog/dogstatsd-ruby/issues/71
[#72]: https://github.com/DataDog/dogstatsd-ruby/issues/72
[#73]: https://github.com/DataDog/dogstatsd-ruby/issues/73
[#74]: https://github.com/DataDog/dogstatsd-ruby/issues/74
[#75]: https://github.com/DataDog/dogstatsd-ruby/issues/75
[#76]: https://github.com/DataDog/dogstatsd-ruby/issues/76
[#77]: https://github.com/DataDog/dogstatsd-ruby/issues/77
[@AMekss]: https://github.com/AMekss
[@adimitrov]: https://github.com/adimitrov
[@degemer]: https://github.com/degemer
[@djpate]: https://github.com/djpate
[@fimmtiu]: https://github.com/fimmtiu
[@gleseur]: https://github.com/gleseur
[@grosser]: https://github.com/grosser
[@jacobbednarz]: https://github.com/jacobbednarz
[@janester]: https://github.com/janester
[@misterbyrne]: https://github.com/misterbyrne
[@nelhage]: https://github.com/nelhage
[@olefriis]: https://github.com/olefriis
[@pschambacher]: https://github.com/pschambacher
[@ramfjord]: https://github.com/ramfjord
[@sensadrome]: https://github.com/sensadrome
[@sj26]: https://github.com/sj26
[@sullerandras]: https://github.com/sullerandras
